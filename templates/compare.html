<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE College Comparison 2023-2024</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        .select2-container {
            width: 100% !important;
        }
        .select2-selection {
            background-color: rgba(255, 255, 255, 0.7) !important;
            border: 1px solid #ccc !important;
            border-radius: 4px !important;
            min-height: 38px !important;
        }
        .select2-selection__choice {
            background-color: #4f46e5 !important;
            color: white !important;
            border: none !important;
            border-radius: 4px !important;
            padding: 2px 8px !important;
            margin: 2px !important;
        }
        .select2-selection__choice__remove {
            color: white !important;
            margin-right: 5px !important;
        }
        .probability-very-high {
            background-color: #10B981;
            color: white;
        }
        .probability-high {
            background-color: #6EE7B7;
            color: black;
        }
        .probability-medium {
            background-color: #FBBF24;
            color: black;
        }
        .probability-low {
            background-color: #F87171;
            color: white;
        }
        .probability-very-low {
            background-color: #EF4444;
            color: white;
        }
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            flex-direction: column;
        }
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-400">
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <div>Processing your request...</div>
    </div>

    <header class="text-gray-400 bg-gray-900 body-font">
        <div class="container mx-auto flex flex-wrap p-5 flex-col md:flex-row items-center">
            <!-- Logo and Name -->
            <a href="/" class="flex order-first lg:order-none lg:w-2/5 title-font font-medium items-center text-white lg:items-center lg:justify-center mb-4 md:mb-0">
                <img src="https://i.ibb.co/y42LjdW/p.png" class="w-14 h-14 text-white bg-gray-900" alt="Logo">
                <h1 class="flex items-center text-3xl font-extrabold text-white dark:text-gray-100">Mahenju<span class="bg-blue-100 text-blue-800 text-3xl font-semibold me-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 ms-2">Web</span></h1>
            </a>
        </div>
    </header>

    <section class="container mx-auto px-5 py-12">
        <div class="text-center mb-12">
            <h1 class="sm:text-5xl text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-pink-500 text-center title-font mb-4">JEE College Comparison 2023-2024</h1>
            <p class="text-base leading-relaxed xl:w-2/4 font-bold py-2 text-white lg:w-3/4 mx-auto">
                <i>Compare college cutoffs from 2023 and 2024 to make better decisions. Get personalized probability estimates based on your rank.</i>
            </p>
        </div>

        <div class="flex flex-wrap -m-4">
            <div class="p-4 md:w-1/2 w-full">
                <div class="h-full bg-gray-800 bg-opacity-40 p-6 rounded-lg">
                    <form id="comparisonForm" class="w-full">
                        <div class="flex flex-wrap mb-6">
                            <div class="w-full px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-orange-600">
                                    Your Rank
                                </label>
                                <input class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-300 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" id="rank" type="number" placeholder="Enter Your Category Rank" required>
                            </div>
                            
                            <div class="w-full md:w-1/2 px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-yellow-600">
                                    Category
                                </label>
                                <div class="relative">
                                    <select class="block appearance-none w-full bg-gray-200 border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500" id="category" required>
                                        <option value="" disabled selected>Select Category</option>
                                        <option>OPEN</option>
                                        <option>OBC-NCL</option>
                                        <option>EWS</option>
                                        <option>SC</option>
                                        <option>ST</option>
                                        <option>OPEN-PWD</option>
                                        <option>OBC-PWD</option>
                                        <option>EWS-PWD</option>
                                        <option>SC-PWD</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="w-full md:w-1/2 px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-green-600">
                                    Gender
                                </label>
                                <div class="relative">
                                    <select class="block appearance-none w-full bg-gray-200 border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500" id="gender" required>
                                        <option value="" disabled selected>Select Gender</option>
                                        <option>MALE</option>
                                        <option>FEMALE</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="w-full px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-600">
                                    Home State
                                </label>
                                <div class="relative">
                                    <select class="block appearance-none w-full bg-gray-200 border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500" id="hs" required>
                                        <option value="" disabled selected>Select Home State</option>
                                        <option>Andhra Pradesh</option>
                                        <option>Arunachal Pradesh</option>
                                        <option>Assam</option>
                                        <option>Bihar</option>
                                        <option>Chhattisgarh</option>
                                        <option>Goa</option>
                                        <option>Gujarat</option>
                                        <option>Haryana</option>
                                        <option>Himachal Pradesh</option>
                                        <option>Jharkhand</option>
                                        <option>Karnataka</option>
                                        <option>Kerala</option>
                                        <option>Madhya Pradesh</option>
                                        <option>Maharashtra</option>
                                        <option>Manipur</option>
                                        <option>Meghalaya</option>
                                        <option>Mizoram</option>
                                        <option>Nagaland</option>
                                        <option>Odisha</option>
                                        <option>Punjab</option>
                                        <option>Rajasthan</option>
                                        <option>Sikkim</option>
                                        <option>Tamil Nadu</option>
                                        <option>Telangana</option>
                                        <option>Tripura</option>
                                        <option>Uttar Pradesh</option>
                                        <option>Uttarakhand</option>
                                        <option>West Bengal</option>
                                        <option>Andaman and Nicobar Islands</option>
                                        <option>Chandigarh</option>
                                        <option>Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option>Delhi</option>
                                        <option>Jammu and Kashmir</option>
                                        <option>Ladakh</option>
                                        <option>Lakshadweep</option>
                                        <option>Puducherry</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="w-full px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-600">
                                    College Types
                                </label>
                                <select class="select2-multi" id="colleges" multiple="multiple" required>
                                    <option value="ALL">All Colleges</option>
                                    <option value="IIT">IITs</option>
                                    <option value="NIT">NITs</option>
                                    <option value="IIIT">IIITs</option>
                                    <option value="GFTI">GFTIs</option>
                                </select>
                            </div>
                            
                            <div class="w-full px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-600">
                                    Branches
                                </label>
                                <select class="select2-multi" id="branches" multiple="multiple" required>
                                    <option value="ALL">All Branches</option>
                                    <option>Computer Science and Engineering</option>
                                    <option>Electronics and Communication Engineering</option>
                                    <option>Electrical Engineering</option>
                                    <option>Mechanical Engineering</option>
                                    <option>Civil Engineering</option>
                                    <option>Chemical Engineering</option>
                                    <option>Aerospace Engineering</option>
                                    <option>Biotechnology</option>
                                    <option>Metallurgical Engineering</option>
                                    <option>Mining Engineering</option>
                                    <option>Petroleum Engineering</option>
                                    <option>Production Engineering</option>
                                    <option>Textile Engineering</option>
                                    <option>Agricultural Engineering</option>
                                    <option>Industrial Engineering</option>
                                    <option>Environmental Engineering</option>
                                    <option>Ceramic Engineering</option>
                                    <option>Architecture</option>
                                    <option>Mathematics and Computing</option>
                                    <option>Engineering Physics</option>
                                    <option>Engineering Chemistry</option>
                                    <option>Data Science and AI</option>
                                    <option>AI and ML</option>
                                </select>
                            </div>
                            
                            <div class="w-full px-3 mb-6">
                                <label class="block uppercase tracking-wide text-xs font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">
                                    Specific Colleges
                                </label>
                                <select class="select2-multi" id="collegenames" multiple="multiple" required>
                                    <option value="ALL">All College Names</option>
                                    <!-- Will be populated dynamically -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex flex-wrap mb-6">
                            <div class="w-full px-3">
                                <button type="submit" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105">
                                    Compare & Predict
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="p-4 md:w-1/2 w-full">
                <div class="h-full bg-gray-800 bg-opacity-40 p-6 rounded-lg overflow-auto" style="max-height: 800px;">
                    <h2 class="text-2xl font-bold text-white mb-4">Results</h2>
                    <div id="results" class="text-gray-300">
                        <p class="text-center py-10">Enter your details and click "Compare & Predict" to see results.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        $(document).ready(function() {
            // Initialize Select2 for multi-select dropdowns
            $('.select2-multi').select2({
                placeholder: "Select options",
                allowClear: true,
                tags: true
            });
            
            // Populate college names from CSV files (simplified for now)
            const collegeNames = [
                "Indian Institute of Technology Bombay",
                "Indian Institute of Technology Delhi",
                "Indian Institute of Technology Madras",
                "Indian Institute of Technology Kanpur",
                "Indian Institute of Technology Kharagpur",
                "Indian Institute of Technology Roorkee",
                "Indian Institute of Technology Guwahati",
                "Indian Institute of Technology Hyderabad",
                "National Institute of Technology Tiruchirappalli",
                "National Institute of Technology Surathkal",
                "National Institute of Technology Warangal",
                "National Institute of Technology Calicut",
                "IIIT Hyderabad",
                "IIIT Delhi",
                "IIIT Bangalore",
                "BITS Pilani",
                "SLIET Longowal"
            ];
            
            // Add college names to the dropdown
            collegeNames.forEach(college => {
                $('#collegenames').append(new Option(college, college, false, false));
            });
            
            // Form submission
            $('#comparisonForm').on('submit', function(e) {
                e.preventDefault();
                
                // Show loading spinner
                $('#loading').removeClass('hidden');
                
                // Get form data
                const formData = {
                    rank: $('#rank').val(),
                    category: $('#category').val(),
                    gender: $('#gender').val(),
                    hs: $('#hs').val(),
                    colleges: $('#colleges').val(),
                    branches: $('#branches').val(),
                    collegenames: $('#collegenames').val()
                };
                
                // Send AJAX request
                $.ajax({
                    url: '/compare/process_data',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function(response) {
                        displayResults(response);
                        $('#loading').addClass('hidden');
                    },
                    error: function(error) {
                        console.error('Error:', error);
                        $('#results').html(`<p class="text-red-500">Error: ${error.responseJSON?.error || 'Failed to process request'}</p>`);
                        $('#loading').addClass('hidden');
                    }
                });
            });
            
            // Function to display results
            function displayResults(data) {
                if (data.length === 0) {
                    $('#results').html('<p class="text-center py-10">No matching colleges found for your criteria.</p>');
                    return;
                }
                
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-gray-800 text-white">
                            <thead>
                                <tr class="bg-gray-700">
                                    <th class="px-4 py-2 text-left">College</th>
                                    <th class="px-4 py-2 text-left">Branch</th>
                                    <th class="px-4 py-2 text-left">2024 Closing</th>
                                    <th class="px-4 py-2 text-left">2023 Closing</th>
                                    <th class="px-4 py-2 text-left">Probability</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                data.forEach(item => {
                    const probabilityClass = `probability-${item.Probability.toLowerCase().replace(' ', '-')}`;
                    
                    html += `
                        <tr class="border-b border-gray-700 hover:bg-gray-600">
                            <td class="px-4 py-3">${item.College}</td>
                            <td class="px-4 py-3">${item.Branch}</td>
                            <td class="px-4 py-3">${item['Closing Rank 2024'] || 'N/A'}</td>
                            <td class="px-4 py-3">${item['Closing Rank 2023'] || 'N/A'}</td>
                            <td class="px-4 py-3">
                                <span class="px-2 py-1 rounded ${probabilityClass}">
                                    ${item.Probability}
                                </span>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-6">
                        <h3 class="text-xl font-bold text-white mb-2">Probability Legend:</h3>
                        <div class="flex flex-wrap gap-2">
                            <span class="px-2 py-1 rounded probability-very-high">Very High</span>
                            <span class="px-2 py-1 rounded probability-high">High</span>
                            <span class="px-2 py-1 rounded probability-medium">Medium</span>
                            <span class="px-2 py-1 rounded probability-low">Low</span>
                            <span class="px-2 py-1 rounded probability-very-low">Very Low</span>
                        </div>
                        <p class="mt-2 text-sm">Based on the difference between your rank and the closing rank.</p>
                    </div>
                `;
                
                $('#results').html(html);
            }
        });
    </script>
</body>
</html> 